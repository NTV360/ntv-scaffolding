<div
  class="donut-graph-container"
  [ngClass]="{
  'donut-graph-small': isSmall(),
  'donut-graph-medium': size() === 'medium',
  'donut-graph-large': isLarge(),
  'donut-graph-fullscreen': isFullscreen(),
  'donut-graph-auto': isAuto()
}"
>
  <!-- Header Section -->
  <div class="donut-graph-header" *ngIf="title()">
    <div class="donut-graph-title-section">
      <div class="donut-graph-icon">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="14"
          height="17"
          viewBox="0 0 14 17"
          fill="none"
        >
          <mask
            id="path-1-outside-1_3663_5475"
            maskUnits="userSpaceOnUse"
            x="0"
            y="0"
            width="14"
            height="17"
            fill="black"
          >
            <rect fill="white" width="14" height="17" />
            <path
              d="M11.9515 7.97676L11.8338 7.79896C11.8338 6.38117 11.1849 5.84777 10.4737 5.43444C10.7115 5.3744 10.9471 5.31667 11.0071 5.02111C11.4204 4.90334 11.4805 4.72554 11.5382 4.54774C11.656 4.48771 11.9515 4.31221 11.9515 3.95661C12.1293 3.83885 12.2471 3.66105 12.1894 3.42552C12.3672 3.18768 12.4249 3.00988 12.3672 2.83439C12.6027 2.53882 12.4849 2.36102 12.4249 2.18322C12.6027 1.82762 12.4249 1.47433 11.9515 1.53206C11.776 1.23649 11.3027 1.29653 11.2426 1.29653C11.1849 1.17876 11.0648 1.11873 10.7693 1.17876C10.4737 1.00096 10.2382 1.00096 10.0026 1.11873C9.70708 0.883197 9.52928 1.061 9.35148 1.11873C8.99588 1.00096 8.93815 1.17876 8.76035 1.23649C8.40475 1.17876 8.28698 1.35656 8.10918 1.53206H7.93369C7.40029 1.82762 7.10472 2.53882 6.98696 2.83439C6.86919 2.47879 6.63136 1.82762 6.04023 1.53206H5.86474C5.68693 1.35656 5.56917 1.17876 5.21357 1.23649C5.03577 1.17876 4.97804 1.00096 4.62244 1.11873C4.50467 1.061 4.38691 1.00096 4.20911 1.00096C4.14907 1.00096 4.09135 1.061 3.97127 1.11873C3.73574 1.00096 3.50022 1.00096 3.32241 1.17876C3.02685 1.11873 2.90909 1.23649 2.84905 1.29653C2.78901 1.29653 2.31795 1.23649 2.14015 1.53206C1.60675 1.47433 1.43126 1.82762 1.60675 2.18322C1.48899 2.36102 1.43126 2.47879 1.66679 2.83439C1.54902 2.95215 1.60675 3.18768 1.84459 3.36548C1.78455 3.60101 1.84459 3.77881 2.08012 3.95661C2.02239 4.25218 2.37568 4.42998 2.43572 4.54774C2.49345 4.72554 2.55348 4.90334 2.96681 5.02111C3.02685 5.31667 3.26238 5.3744 3.50022 5.43444C2.73128 5.84777 2.14015 6.4389 2.14015 7.79896L2.02239 7.97676C1.19342 8.50785 0.424492 10.1635 1.60675 11.5235C1.66679 11.9369 1.78455 12.2324 1.90232 12.588C2.08012 13.9458 3.20465 14.597 3.50022 14.657C3.91354 15.0103 4.38691 15.3058 5.03577 15.5437C5.6269 16.1348 6.27806 16.3703 6.92692 16.3703C7.57809 16.3703 8.22925 16.1348 8.82038 15.5437C9.46924 15.3058 9.94261 15.0103 10.3559 14.657C10.6515 14.597 11.776 13.9458 11.9515 12.588C12.0716 12.2324 12.1894 11.9369 12.3071 11.5235C13.6072 10.1635 12.8382 8.50785 11.9515 7.97676ZM11.1849 7.73892C11.1249 8.33005 8.28698 5.79004 8.76035 5.73C10.1204 5.49447 11.2426 6.2611 11.1849 7.73892ZM8.05145 1.88766C8.05145 2.00542 8.10918 2.06546 8.10918 2.12319C8.28698 1.94769 8.40475 1.76989 8.58255 1.59209C8.58255 1.70986 8.52482 1.76989 8.64258 1.88766C8.76035 1.70986 8.87811 1.59209 9.11595 1.47433C8.99588 1.65213 9.11595 1.70986 9.17368 1.76989C9.35148 1.65213 9.46924 1.53206 9.76481 1.41429C9.70708 1.53206 9.58701 1.59209 9.70708 1.70986C9.88257 1.59209 10.0026 1.53206 10.416 1.41429C10.3559 1.53206 10.1781 1.59209 10.2382 1.70986C10.416 1.65213 10.6515 1.59209 10.8893 1.53206C10.7693 1.65213 10.6515 1.70986 10.7693 1.76989C11.0071 1.70986 11.2426 1.59209 11.5382 1.70986L11.3604 1.88766C11.3604 1.88766 11.776 1.88766 12.0716 1.88766C11.9515 2.06546 11.8338 2.18322 11.776 2.41875C11.776 2.41875 11.9515 2.41875 12.0716 2.41875C11.9515 2.77435 11.716 2.83439 11.656 2.95215C11.716 3.00988 11.8338 3.00988 12.0116 2.95215C11.8938 3.18768 11.716 3.30545 11.5382 3.48325C11.5982 3.54328 11.656 3.54328 11.8338 3.48325C11.656 3.66105 11.4805 3.77881 11.3027 3.95661C11.3604 4.01665 11.4805 4.01665 11.5982 4.01665C11.4204 4.19214 11.1249 4.31221 10.8893 4.42998C10.9471 4.54774 11.0648 4.48771 11.1249 4.48771C10.9471 4.60778 10.6515 4.72554 10.416 4.78327C10.4737 4.84331 10.5337 4.90334 10.6515 4.90334C10.3559 5.07884 9.94261 4.96107 9.82484 5.07884C9.82484 5.13887 9.94261 5.19891 10.0026 5.25664C9.52928 5.25664 8.28698 5.25664 8.05145 4.31221C8.52482 3.77881 9.35148 3.18768 10.8293 2.41875C9.70708 2.83439 8.64258 3.30545 7.81362 4.01665C6.86919 3.54328 7.51805 2.36102 8.05145 1.88766ZM6.98696 5.31667C7.69585 5.31667 8.58255 5.84777 8.58255 6.38117C8.58255 6.85223 7.93369 7.20783 6.98696 7.20783C6.04023 7.20783 5.39137 6.73446 5.39137 6.32113C5.39137 5.9078 6.1603 5.31667 6.98696 5.31667ZM3.38014 4.96107C3.50022 4.96107 3.55794 4.90334 3.61798 4.84331C3.32241 4.72554 3.02685 4.66551 2.84905 4.48771C2.96681 4.48771 3.02685 4.48771 3.14461 4.42998C2.90909 4.31221 2.67125 4.19214 2.43572 4.01665C2.55348 4.01665 2.67125 4.01665 2.73128 3.95661C2.55348 3.83885 2.37568 3.66105 2.19788 3.54328C2.37568 3.54328 2.43572 3.54328 2.49345 3.54328C2.31796 3.30544 2.14015 3.18768 2.02239 2.95215C2.14015 3.00988 2.25792 3.00988 2.37568 2.95215C2.31795 2.83439 2.02239 2.77435 1.90232 2.47879C2.02239 2.47879 2.19788 2.47879 2.19788 2.47879C2.14015 2.24326 2.02239 2.06546 1.96235 1.94769C2.25792 1.94769 2.67125 1.94769 2.67125 1.94769L2.49345 1.70986C2.78901 1.65213 3.08458 1.70986 3.26238 1.76989C3.38014 1.70986 3.26238 1.59209 3.14461 1.53206C3.38014 1.59209 3.61798 1.65213 3.79578 1.70986C3.91354 1.59209 3.73574 1.53206 3.61798 1.41429C4.03131 1.47433 4.14907 1.59209 4.32687 1.70986C4.44464 1.59209 4.32687 1.53206 4.26684 1.41429C4.5624 1.53206 4.68248 1.65213 4.85797 1.76989C4.918 1.70986 4.97804 1.65213 4.918 1.47433C5.03577 1.59209 5.21357 1.70986 5.33133 1.88766C5.4491 1.82762 5.39137 1.70986 5.39137 1.59209C5.56917 1.76989 5.74466 1.94769 5.86474 2.12319C5.92246 2.12319 5.92246 2.00542 5.92246 1.88766C6.39583 2.36102 7.10472 3.54328 6.10026 4.01665C5.2736 3.30545 4.20911 2.77435 3.08458 2.41875C4.5624 3.18768 5.39137 3.77881 5.86474 4.31221C5.6269 5.25664 4.38691 5.31667 3.91354 5.25664C4.03131 5.19891 4.09135 5.13887 4.09135 5.07884C4.03131 5.02111 3.67571 5.07884 3.38014 4.96107ZM5.03577 5.66997C5.50913 5.73 2.67125 8.27232 2.61352 7.68119C2.55348 6.2611 3.67571 5.43444 5.03577 5.66997ZM2.02239 11.2857C1.31119 10.6946 1.07566 9.09898 2.37568 8.33005C3.14461 8.09452 2.67125 11.5235 2.02239 11.2857ZM4.7402 14.2414C4.32687 14.4792 3.38014 14.3614 2.73128 13.4147C2.25792 12.588 2.31795 11.7591 2.67125 11.5235C3.14461 11.228 3.91354 11.6413 4.44464 12.2925C4.918 12.8236 5.15353 13.8881 4.7402 14.2414ZM3.97127 10.6368C3.26238 10.1635 3.14461 9.09898 3.67571 8.21229C4.26684 7.38563 5.27361 7.03003 5.9825 7.50339C6.69139 7.97676 6.80916 9.04125 6.27806 9.92795C5.74466 10.8146 4.68248 11.1102 3.97127 10.6368ZM6.98696 15.897C6.10026 15.957 5.27361 15.1881 5.27361 14.9526C5.27361 14.597 6.33579 14.3014 7.04699 14.3014C7.75589 14.2414 8.70031 14.5369 8.70031 14.8925C8.70031 15.128 7.81362 15.897 6.98696 15.897ZM8.76035 12.1147C8.76035 13.0014 7.99142 13.7103 7.04699 13.7103C6.10026 13.7103 5.27361 13.0014 5.27361 12.1147C5.27361 11.228 6.04023 10.5191 6.98696 10.5191C7.99142 10.5191 8.76035 11.228 8.76035 12.1147ZM7.69585 9.86791C7.10472 9.04125 7.28252 7.91672 7.99142 7.44336C8.70031 6.9723 9.76481 7.26786 10.2982 8.15456C10.8293 9.04125 10.7115 10.1034 10.0026 10.5768C9.29144 10.9901 8.22926 10.6946 7.69585 9.86791ZM11.2426 13.4147C10.4737 14.4792 9.46924 14.4792 9.11595 14.1836C8.70031 13.828 8.99588 12.6458 9.58701 11.9969C10.1781 11.2857 10.8893 10.8146 11.3027 11.1679C11.5982 11.5813 11.776 12.7058 11.2426 13.4147ZM11.776 11.228C11.1249 11.5235 10.5938 8.09452 11.4204 8.27232C12.7205 8.98122 12.4849 10.6368 11.776 11.228Z"
            />
          </mask>
          <path
            d="M11.9515 7.97676L11.8338 7.79896C11.8338 6.38117 11.1849 5.84777 10.4737 5.43444C10.7115 5.3744 10.9471 5.31667 11.0071 5.02111C11.4204 4.90334 11.4805 4.72554 11.5382 4.54774C11.656 4.48771 11.9515 4.31221 11.9515 3.95661C12.1293 3.83885 12.2471 3.66105 12.1894 3.42552C12.3672 3.18768 12.4249 3.00988 12.3672 2.83439C12.6027 2.53882 12.4849 2.36102 12.4249 2.18322C12.6027 1.82762 12.4249 1.47433 11.9515 1.53206C11.776 1.23649 11.3027 1.29653 11.2426 1.29653C11.1849 1.17876 11.0648 1.11873 10.7693 1.17876C10.4737 1.00096 10.2382 1.00096 10.0026 1.11873C9.70708 0.883197 9.52928 1.061 9.35148 1.11873C8.99588 1.00096 8.93815 1.17876 8.76035 1.23649C8.40475 1.17876 8.28698 1.35656 8.10918 1.53206H7.93369C7.40029 1.82762 7.10472 2.53882 6.98696 2.83439C6.86919 2.47879 6.63136 1.82762 6.04023 1.53206H5.86474C5.68693 1.35656 5.56917 1.17876 5.21357 1.23649C5.03577 1.17876 4.97804 1.00096 4.62244 1.11873C4.50467 1.061 4.38691 1.00096 4.20911 1.00096C4.14907 1.00096 4.09135 1.061 3.97127 1.11873C3.73574 1.00096 3.50022 1.00096 3.32241 1.17876C3.02685 1.11873 2.90909 1.23649 2.84905 1.29653C2.78901 1.29653 2.31795 1.23649 2.14015 1.53206C1.60675 1.47433 1.43126 1.82762 1.60675 2.18322C1.48899 2.36102 1.43126 2.47879 1.66679 2.83439C1.54902 2.95215 1.60675 3.18768 1.84459 3.36548C1.78455 3.60101 1.84459 3.77881 2.08012 3.95661C2.02239 4.25218 2.37568 4.42998 2.43572 4.54774C2.49345 4.72554 2.55348 4.90334 2.96681 5.02111C3.02685 5.31667 3.26238 5.3744 3.50022 5.43444C2.73128 5.84777 2.14015 6.4389 2.14015 7.79896L2.02239 7.97676C1.19342 8.50785 0.424492 10.1635 1.60675 11.5235C1.66679 11.9369 1.78455 12.2324 1.90232 12.588C2.08012 13.9458 3.20465 14.597 3.50022 14.657C3.91354 15.0103 4.38691 15.3058 5.03577 15.5437C5.6269 16.1348 6.27806 16.3703 6.92692 16.3703C7.57809 16.3703 8.22925 16.1348 8.82038 15.5437C9.46924 15.3058 9.94261 15.0103 10.3559 14.657C10.6515 14.597 11.776 13.9458 11.9515 12.588C12.0716 12.2324 12.1894 11.9369 12.3071 11.5235C13.6072 10.1635 12.8382 8.50785 11.9515 7.97676ZM11.1849 7.73892C11.1249 8.33005 8.28698 5.79004 8.76035 5.73C10.1204 5.49447 11.2426 6.2611 11.1849 7.73892ZM8.05145 1.88766C8.05145 2.00542 8.10918 2.06546 8.10918 2.12319C8.28698 1.94769 8.40475 1.76989 8.58255 1.59209C8.58255 1.70986 8.52482 1.76989 8.64258 1.88766C8.76035 1.70986 8.87811 1.59209 9.11595 1.47433C8.99588 1.65213 9.11595 1.70986 9.17368 1.76989C9.35148 1.65213 9.46924 1.53206 9.76481 1.41429C9.70708 1.53206 9.58701 1.59209 9.70708 1.70986C9.88257 1.59209 10.0026 1.53206 10.416 1.41429C10.3559 1.53206 10.1781 1.59209 10.2382 1.70986C10.416 1.65213 10.6515 1.59209 10.8893 1.53206C10.7693 1.65213 10.6515 1.70986 10.7693 1.76989C11.0071 1.70986 11.2426 1.59209 11.5382 1.70986L11.3604 1.88766C11.3604 1.88766 11.776 1.88766 12.0716 1.88766C11.9515 2.06546 11.8338 2.18322 11.776 2.41875C11.776 2.41875 11.9515 2.41875 12.0716 2.41875C11.9515 2.77435 11.716 2.83439 11.656 2.95215C11.716 3.00988 11.8338 3.00988 12.0116 2.95215C11.8938 3.18768 11.716 3.30545 11.5382 3.48325C11.5982 3.54328 11.656 3.54328 11.8338 3.48325C11.656 3.66105 11.4805 3.77881 11.3027 3.95661C11.3604 4.01665 11.4805 4.01665 11.5982 4.01665C11.4204 4.19214 11.1249 4.31221 10.8893 4.42998C10.9471 4.54774 11.0648 4.48771 11.1249 4.48771C10.9471 4.60778 10.6515 4.72554 10.416 4.78327C10.4737 4.84331 10.5337 4.90334 10.6515 4.90334C10.3559 5.07884 9.94261 4.96107 9.82484 5.07884C9.82484 5.13887 9.94261 5.19891 10.0026 5.25664C9.52928 5.25664 8.28698 5.25664 8.05145 4.31221C8.52482 3.77881 9.35148 3.18768 10.8293 2.41875C9.70708 2.83439 8.64258 3.30545 7.81362 4.01665C6.86919 3.54328 7.51805 2.36102 8.05145 1.88766ZM6.98696 5.31667C7.69585 5.31667 8.58255 5.84777 8.58255 6.38117C8.58255 6.85223 7.93369 7.20783 6.98696 7.20783C6.04023 7.20783 5.39137 6.73446 5.39137 6.32113C5.39137 5.9078 6.1603 5.31667 6.98696 5.31667ZM3.38014 4.96107C3.50022 4.96107 3.55794 4.90334 3.61798 4.84331C3.32241 4.72554 3.02685 4.66551 2.84905 4.48771C2.96681 4.48771 3.02685 4.48771 3.14461 4.42998C2.90909 4.31221 2.67125 4.19214 2.43572 4.01665C2.55348 4.01665 2.67125 4.01665 2.73128 3.95661C2.55348 3.83885 2.37568 3.66105 2.19788 3.54328C2.37568 3.54328 2.43572 3.54328 2.49345 3.54328C2.31796 3.30544 2.14015 3.18768 2.02239 2.95215C2.14015 3.00988 2.25792 3.00988 2.37568 2.95215C2.31795 2.83439 2.02239 2.77435 1.90232 2.47879C2.02239 2.47879 2.19788 2.47879 2.19788 2.47879C2.14015 2.24326 2.02239 2.06546 1.96235 1.94769C2.25792 1.94769 2.67125 1.94769 2.67125 1.94769L2.49345 1.70986C2.78901 1.65213 3.08458 1.70986 3.26238 1.76989C3.38014 1.70986 3.26238 1.59209 3.14461 1.53206C3.38014 1.59209 3.61798 1.65213 3.79578 1.70986C3.91354 1.59209 3.73574 1.53206 3.61798 1.41429C4.03131 1.47433 4.14907 1.59209 4.32687 1.70986C4.44464 1.59209 4.32687 1.53206 4.26684 1.41429C4.5624 1.53206 4.68248 1.65213 4.85797 1.76989C4.918 1.70986 4.97804 1.65213 4.918 1.47433C5.03577 1.59209 5.21357 1.70986 5.33133 1.88766C5.4491 1.82762 5.39137 1.70986 5.39137 1.59209C5.56917 1.76989 5.74466 1.94769 5.86474 2.12319C5.92246 2.12319 5.92246 2.00542 5.92246 1.88766C6.39583 2.36102 7.10472 3.54328 6.10026 4.01665C5.2736 3.30545 4.20911 2.77435 3.08458 2.41875C4.5624 3.18768 5.39137 3.77881 5.86474 4.31221C5.6269 5.25664 4.38691 5.31667 3.91354 5.25664C4.03131 5.19891 4.09135 5.13887 4.09135 5.07884C4.03131 5.02111 3.67571 5.07884 3.38014 4.96107ZM5.03577 5.66997C5.50913 5.73 2.67125 8.27232 2.61352 7.68119C2.55348 6.2611 3.67571 5.43444 5.03577 5.66997ZM2.02239 11.2857C1.31119 10.6946 1.07566 9.09898 2.37568 8.33005C3.14461 8.09452 2.67125 11.5235 2.02239 11.2857ZM4.7402 14.2414C4.32687 14.4792 3.38014 14.3614 2.73128 13.4147C2.25792 12.588 2.31795 11.7591 2.67125 11.5235C3.14461 11.228 3.91354 11.6413 4.44464 12.2925C4.918 12.8236 5.15353 13.8881 4.7402 14.2414ZM3.97127 10.6368C3.26238 10.1635 3.14461 9.09898 3.67571 8.21229C4.26684 7.38563 5.27361 7.03003 5.9825 7.50339C6.69139 7.97676 6.80916 9.04125 6.27806 9.92795C5.74466 10.8146 4.68248 11.1102 3.97127 10.6368ZM6.98696 15.897C6.10026 15.957 5.27361 15.1881 5.27361 14.9526C5.27361 14.597 6.33579 14.3014 7.04699 14.3014C7.75589 14.2414 8.70031 14.5369 8.70031 14.8925C8.70031 15.128 7.81362 15.897 6.98696 15.897ZM8.76035 12.1147C8.76035 13.0014 7.99142 13.7103 7.04699 13.7103C6.10026 13.7103 5.27361 13.0014 5.27361 12.1147C5.27361 11.228 6.04023 10.5191 6.98696 10.5191C7.99142 10.5191 8.76035 11.228 8.76035 12.1147ZM7.69585 9.86791C7.10472 9.04125 7.28252 7.91672 7.99142 7.44336C8.70031 6.9723 9.76481 7.26786 10.2982 8.15456C10.8293 9.04125 10.7115 10.1034 10.0026 10.5768C9.29144 10.9901 8.22926 10.6946 7.69585 9.86791ZM11.2426 13.4147C10.4737 14.4792 9.46924 14.4792 9.11595 14.1836C8.70031 13.828 8.99588 12.6458 9.58701 11.9969C10.1781 11.2857 10.8893 10.8146 11.3027 11.1679C11.5982 11.5813 11.776 12.7058 11.2426 13.4147ZM11.776 11.228C11.1249 11.5235 10.5938 8.09452 11.4204 8.27232C12.7205 8.98122 12.4849 10.6368 11.776 11.228Z"
            fill="#8DCB2C"
          />
        </svg>
      </div>
      <div class="donut-graph-title" *ngIf="title()">{{ title() }}</div>
    </div>
  </div>

  <!-- Chart Content -->
  <div class="donut-graph-content" [ngStyle]="containerStyles()">
    <div
      class="donut-chart-layout"
      [ngClass]="{
           'legend-right': config().legendPosition === 'right' || !config().legendPosition,
           'legend-left': config().legendPosition === 'left',
           'legend-bottom': config().legendPosition === 'bottom',
           'legend-top': config().legendPosition === 'top'
         }"
    >
      <div class="donut-chart-area">
        <div class="donut-chart-container">
          <apx-chart
            #chart
            [series]="chartOptions().series!"
            [chart]="chartOptions().chart!"
            [colors]="chartOptions().colors!"
            [labels]="chartOptions().labels!"
            [dataLabels]="chartOptions().dataLabels!"
            [legend]="{ show: false }"
            [plotOptions]="chartOptions().plotOptions!"
            [stroke]="chartOptions().stroke!"
            [title]="chartOptions().title!"
            [subtitle]="chartOptions().subtitle!"
            [responsive]="chartOptions().responsive!"
            [tooltip]="chartOptions().tooltip!"
          >
          </apx-chart>
          <div class="donut-center-content" *ngIf="displayValue()">
            <div class="donut-center-total">{{ displayValue() }}</div>
          </div>
        </div>
      </div>

      <!-- Custom Legend -->
      <div class="donut-legend" *ngIf="config().showLegend !== false">
        <div
          class="legend-item"
          *ngFor="let item of data(); let i = index"
          [class.legend-item-hovered]="hoveredIndex() === i"
          (mouseenter)="onLegendItemHover(i, true)"
          (mouseleave)="onLegendItemHover(i, false)"
        >
          <span
            class="legend-marker"
            [style.background-color]="getColors(data(), config())[i]"
          >
          </span>
          <!-- Two-column layout -->
          <div class="legend-label-row">
            <span class="legend-label">{{ item.label }}</span>
            <span class="legend-value"
              >{{ calculatePercentage(item.total) }}</span
            >
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
